# 암호화폐 주소 분석을 위한 2단계 하이브리드 리스크 스코어링 시스템

## 초록

암호화폐 시장의 급속한 성장과 함께 피싱, 해킹, 자금 세탁 등 불법 거래가 지속적으로 증가하고 있다. 본 논문은 중앙화 거래소(CEX)를 위한 2단계 하이브리드 리스크 스코어링 시스템을 제안한다. 제안 시스템은 1단계에서 TRACE-X 룰북 기반 규칙 평가와 그래프 통계 분석을 결합하고, 2단계에서 머신러닝 기반 가중치 조정을 수행한다. 92,138개의 라벨링된 이더리움 거래 데이터셋에서 실험한 결과, 제안 시스템은 78.86%의 정확도, 0.6876의 F1-점수, 0.8777의 ROC-AUC를 달성하여 모든 baseline 모델을 능가하였다. 2단계 아키텍처는 규칙 기반 스코어링을 통한 해석 가능성과 머신러닝 정제를 통한 높은 성능을 동시에 제공하여, 실제 AML 규제 준수 응용에 적합하다.

**키워드**: 암호화폐, 리스크 스코어링, 사기 탐지, 그래프 분석, 머신러닝, 블록체인 보안

---

## 1. 서론

### 1.1 연구 배경

암호화폐 시장은 지난 10년간 급속히 성장하여 전 세계적으로 수조 달러 규모의 시장을 형성하였다. 그러나 이러한 성장과 함께 피싱, 해킹, 자금 세탁 등 불법 거래도 지속적으로 증가하고 있다. 특히 블록체인의 익명성 특성으로 인해 전통적인 금융 기관의 규제 시스템으로는 효과적인 탐지가 어렵다.

중앙화 거래소(CEX)는 사용자 자금의 안전을 보장하고 규제 기관의 요구사항을 충족하기 위해, 실시간으로 주소와 거래를 분석하여 리스크를 평가할 수 있는 시스템이 필수적이다. 효과적인 리스크 스코어링 시스템은 의심스러운 주소와 거래를 재정적 피해가 발생하기 전에 식별하는 데 핵심적인 역할을 한다.

### 1.2 문제 정의

기존의 암호화폐 리스크 스코어링 접근법은 각각 한계가 있다:

1. **규칙 기반 시스템**: 해석 가능하고 빠르지만 복잡한 패턴을 놓칠 수 있으며, 새로운 공격 패턴에 대한 수동 룰 유지가 필요하다.

2. **순수 머신러닝 접근법**: 높은 성능을 달성할 수 있지만 설명 가능성이 부족하고, 도메인 지식을 효과적으로 반영하기 어렵다.

3. **그래프 기반 방법**: 강력한 패턴 탐지 능력을 가지지만 계산 비용이 높고 대규모 네트워크로 확장하기 어렵다.

4. **하이브리드 접근법**: 규칙 기반과 ML을 결합하지만, 두 구성 요소 간의 경계가 모호하고 최적화가 어렵다.

### 1.3 연구 기여

본 논문의 주요 기여는 다음과 같다:

1. **2단계 아키텍처**: 규칙 기반/그래프 통계 스코어링(1단계)과 AI 기반 가중치 조정/랭킹(2단계)을 명확하게 분리한 새로운 2단계 하이브리드 리스크 스코어링 시스템을 제안한다.

2. **포괄적 Feature Engineering**: 규칙 기반 features, 그래프 통계, ML 파생 features를 결합한 30차원 feature 공간을 설계한다.

3. **실제 데이터셋**: 2016년부터 2024년까지 8년간 수집된 92,138개의 라벨링된 이더리움 거래 데이터셋을 활용하며, 라벨은 Etherscan 주소 태그에서 파생되었다.

4. **End-to-End 구현**: 실시간 주소 분석을 위한 백엔드 API 로직을 포함한 완전한 구현을 제공하여 실용적 적용 가능성을 입증한다.

5. **성능 평가**: 제안 시스템이 baseline 모델들을 크게 능가하는 성능을 달성하며, 정확도 78.86%, F1-점수 0.6876, ROC-AUC 0.8777을 기록한다.

---

## 2. 관련 연구

### 2.1 규칙 기반 리스크 스코어링

규칙 기반 시스템은 암호화폐 리스크 평가를 위해 다음과 같은 사전 정의된 패턴에 의존한다:

- 제재 대상 주소 리스트(OFAC SDN)
- 알려진 믹서/브릿지 주소
- 거래 금액 임계값
- 시간 기반 패턴

이러한 시스템은 해석 가능하고 빠르지만, 새로운 공격 패턴을 놓칠 수 있으며 수동 룰 유지가 필요하다.

### 2.2 그래프 기반 분석

그래프 기반 방법은 거래 네트워크를 분석하여 의심스러운 패턴을 탐지한다:

- **Fan-in/Fan-out 패턴**: 자금 집중 또는 분산 탐지
- **Gather-scatter 패턴**: 자금 세탁 구조 식별
- **Personalized PageRank (PPR)**: 알려진 위험 주소와의 근접성 측정

이러한 방법은 강력하지만 계산 비용이 높고 대규모 네트워크로 확장하기 어렵다.

### 2.3 머신러닝 접근법

머신러닝 모델이 암호화폐 사기 탐지에 적용되었다:

- **지도 학습**: 라벨링된 데이터를 사용하여 분류기 학습
- **Feature Engineering**: 거래 데이터에서 의미 있는 feature 추출
- **앙상블 방법**: 여러 모델을 결합하여 성능 개선

그러나 순수 ML 접근법은 종종 해석 가능성이 부족하고 도메인 특화 지식을 효과적으로 포착하기 어렵다.

### 2.4 하이브리드 접근법

하이브리드 시스템은 규칙 기반과 ML 구성 요소를 결합한다:

- **규칙 기반 + ML**: 초기 필터링에 규칙 사용, 최종 스코어링에 ML 사용
- **그래프 + ML**: 그래프 features와 ML 모델 결합
- **다단계 시스템**: 서로 다른 분석 단계 분리

본 연구는 각 단계에 대한 명확한 책임을 가진 2단계 아키텍처를 제안하여 하이브리드 접근법을 확장한다.

---

## 3. 데이터셋

### 3.1 데이터 출처

본 연구는 Graph of Graphs (GOG) 논문의 연구자들이 수집한 데이터셋을 활용하며, 이는 세 가지 주요 체인의 라벨링된 블록체인 데이터를 포함한다:

- **이더리움**: 14,464개 토큰, 81,788,211개 거래, 10,247,767개 주소 (2016-02 ~ 2024-02)
- **Polygon**: 2,353개 토큰, 64,882,233개 거래, 1,801,976개 주소 (2020-08 ~ 2024-02)
- **BSC**: 7,499개 토큰, 121,612,480개 거래, 6,550,399개 주소 (2020-09 ~ 2024-02)

실험을 위해 일관성과 데이터 품질을 보장하기 위해 이더리움 데이터에 집중한다.

### 3.2 라벨링 방법론

라벨은 **Etherscan 주소 태그**에서 파생되며, 이는 공개적으로 이용 가능하고 암호화폐 커뮤니티에서 널리 신뢰받는다:

#### 사기 라벨 (`label = 1`)

- **피싱 태그**: 피싱 공격과 관련된 주소
- **해킹 태그**: 해킹 사건에 연루된 주소
- **스캠 태그**: 스캠으로 식별된 주소
- **기타 의심스러운 태그**: 추가 위험 지표

#### 정상 라벨 (`label = 0`)

- **금융 태그**: 합법적인 금융 서비스 주소
- **밈 태그**: 밈 토큰 주소 (정상으로 간주)
- **기타 카테고리 태그**: 추가 합법 카테고리
- **태그 없음**: 특정 태그가 없는 주소 (정상으로 가정)

#### 라벨 신뢰도

**장점**:

- **공식 데이터 출처**: Etherscan은 가장 신뢰받는 이더리움 블록체인 탐색기
- **운영 관련성**: 태그는 CEX와 규제 기관에서 사용됨
- **일관성**: 균일한 라벨링 기준으로 주관적 판단 최소화

**한계**:

- **불완전성**: 모든 위험 주소가 태그되지 않을 수 있음
- **업데이트 지연**: 태그가 실시간으로 업데이트되지 않을 수 있음
- **정의 모호성**: "피싱"과 "스캠" 사이의 경계가 불명확할 수 있음
- **시간적 변화**: 주소가 시간에 따라 재분류될 수 있음

### 3.3 데이터 구조

#### Features 파일

Features 파일(`ethereum_basic_metrics_processed.csv`)은 주소 레벨 라벨과 그래프 통계를 포함한다:

- `Chain`: 블록체인 식별자
- `Contract`: 컨트랙트 주소
- `Num_nodes`, `Num_edges`: 그래프 구조 메트릭
- `Density`, `Assortativity`, `Reciprocity`: 그래프 속성
- `Effective_Diameter`, `Clustering_Coefficient`: 추가 그래프 메트릭
- `label`: 이진 라벨 (0=정상, 1=사기)

#### 거래 파일

거래 파일(`legacy/data/transactions/ethereum/{address}.csv`)은 거래 레벨 데이터를 포함한다:

- `block_number`: 블록 번호
- `from`, `to`: 거래 주소
- `transaction_hash`: 거래 식별자
- `value`: 거래 금액 (Wei)
- `timestamp`: Unix 타임스탬프

**참고**: 거래 파일에는 라벨이 포함되지 않으며, 라벨은 주소 레벨에서 적용된다.

### 3.4 데이터 매칭 프로세스

학습을 위한 거래 레벨 데이터셋을 생성하기 위해 다음을 수행한다:

1. Features 파일에서 주소 레벨 라벨 추출
2. 각 주소에 대한 해당 거래 파일 로드
3. 해당 주소의 모든 거래에 주소 레벨 라벨 적용
4. 각 거래에 대해 규칙 평가 및 feature 추출
5. 데이터 누수를 방지하기 위해 규칙 결과 및 점수 제거

### 3.5 최종 데이터셋

최종 데이터셋은 다음을 포함한다:

- **총 샘플 수**: 92,138개 (이더리움)
- **정상**: 58.1% (53,500개 샘플)
- **사기**: 41.9% (38,638개 샘플)

학습을 위해 5,000개 샘플의 샘플링된 데이터셋을 사용한다:

- **학습**: 3,499개 샘플 (70%)
- **검증**: 749개 샘플 (15%)
- **테스트**: 752개 샘플 (15%)

데이터셋은 계층적 샘플링을 사용하여 분할 간 라벨 분포를 유지한다.

---

## 4. 시스템 아키텍처

### 4.1 개요

제안하는 2단계 하이브리드 리스크 스코어링 시스템은 다음으로 구성된다:

1. **1단계: 규칙 기반 + 그래프 통계 스코어링**

   - 사전 정의된 규칙을 사용한 규칙 기반 스코어링
   - 그래프 통계 feature 추출
   - 규칙 점수와 그래프 점수의 가중 결합

2. **2단계: AI 가중치 조정 및 랭킹**
   - 1단계 결과로부터 feature 추출
   - 최종 스코어링을 위한 머신러닝 모델
   - PPR 기반 features 통합

### 4.2 1단계: 규칙 기반 + 그래프 통계 스코어링

#### 4.2.1 규칙 기반 스코어링

개선된 규칙 기반 스코어러(`ImprovedRuleScorer`)를 사용하며, 이는 다음을 수행한다:

1. **개별 규칙 평가**: 거래 데이터에 대해 개별 규칙 평가
2. **규칙 점수 계산**: 명시적 점수가 없을 때 심각도 기반 기본값 사용
3. **점수 집계**: 중복 규칙 페널티를 포함한 가중 합산 사용
4. **보너스 적용**:
   - 규칙 개수 (더 많은 고유 규칙 = 더 높은 보너스)
   - 심각도 (CRITICAL/HIGH 규칙 = 더 높은 보너스)
   - 축 다양성 (여러 축에서 규칙 발동 = 보너스)
5. **컨텍스트 통합**: 거래 메타데이터 및 ML features로부터 컨텍스트 통합

**규칙 카테고리**:

- **축 A**: 금액 관련 규칙 (고액 거래, 비정상 금액)
- **축 B**: 행동 패턴 (급속 거래, 비정상 타이밍)
- **축 C**: 연결성 (위험 주소와의 연결)
- **축 D**: 시간 패턴 (시간 기반 이상)
- **축 E**: 노출 (제재/믹서/브릿지 연결)

**심각도 레벨**:

- **CRITICAL**: 25.0 기본 점수
- **HIGH**: 20.0 기본 점수
- **MEDIUM**: 10.0 기본 점수
- **LOW**: 5.0 기본 점수

#### 4.2.2 그래프 통계 스코어링

그래프 통계는 거래 네트워크로부터 추출된다:

**Fan-in/Fan-out 통계**:

- `fan_in_count`: 유입 거래 개수
- `fan_out_count`: 유출 거래 개수
- `fan_in_value`: 유입 거래 총액
- `fan_out_value`: 유출 거래 총액
- `tx_from_fan_out_count`: 거래 송신자의 Fan-out 개수
- `tx_to_fan_in_count`: 거래 수신자의 Fan-in 개수
- `tx_primary_fan_in/out_count`: 주요 주소(가장 연결된)의 Fan-in/out

**패턴 탐지**:

- `pattern_score`: 탐지된 패턴으로부터 집계된 점수
- `fan_in_detected`: Fan-in 패턴에 대한 이진 지표
- `fan_out_detected`: Fan-out 패턴에 대한 이진 지표
- `gather_scatter_detected`: Gather-scatter 패턴에 대한 이진 지표
- `stack_detected`: Stack 패턴에 대한 이진 지표
- `bipartite_detected`: Bipartite 패턴에 대한 이진 지표

**거래 금액 통계**:

- `avg_transaction_value`: 평균 거래 금액
- `max_transaction_value`: 최대 거래 금액
- `min_transaction_value`: 최소 거래 금액
- `total_transaction_value`: 총 거래 금액
- `transaction_count`: 거래 개수

**그래프 레벨 통계**:

- `avg_fan_in_count`: 모든 노드에 걸친 평균 Fan-in 개수
- `avg_fan_out_count`: 모든 노드에 걸친 평균 Fan-out 개수
- `avg_fan_in_value`: 모든 노드에 걸친 평균 Fan-in 값
- `avg_fan_out_value`: 모든 노드에 걸친 평균 Fan-out 값

**그래프 점수 계산**:

그래프 점수는 다음을 통해 계산된다:

1. 그래프 features를 0-100 스케일로 정규화
2. 사기 지표에 대한 역방향 스코어링 적용 (낮은 pattern_score = 높은 위험)
3. 학습된 가중치로 features 결합
4. 정상 패턴에 대한 페널티 적용

#### 4.2.3 1단계 최종 점수

1단계 리스크 점수는 다음과 같이 계산된다:

```
risk_score = rule_weight × rule_score + graph_weight × graph_score
```

여기서:

- `rule_weight = 0.9` (최적화됨)
- `graph_weight = 0.1` (최적화됨)

### 4.3 2단계: AI 가중치 조정 및 랭킹

#### 4.3.1 Feature 추출

30차원 feature 벡터를 추출한다:

**1단계 Features (3차원)**:

- `rule_score`: 1단계의 규칙 기반 점수
- `graph_score`: 1단계의 그래프 통계 점수
- `risk_score`: 결합된 1단계 리스크 점수

**규칙 기반 Features (9차원)**:

- `rule_count`: 발동된 규칙 개수
- `axis_A_count`: 축 A(금액)의 규칙 개수
- `axis_B_count`: 축 B(행동)의 규칙 개수
- `axis_C_count`: 축 C(연결성)의 규칙 개수
- `axis_D_count`: 축 D(시간)의 규칙 개수
- `axis_E_count`: 축 E(노출)의 규칙 개수
- `severity_CRITICAL_count`: CRITICAL 규칙 개수
- `severity_HIGH_count`: HIGH 규칙 개수
- `severity_MEDIUM_count`: MEDIUM 규칙 개수

**그래프 통계 Features (10차원)**:

- `fan_in_count`: 정규화된 Fan-in 개수
- `fan_out_count`: 정규화된 Fan-out 개수
- `tx_primary_fan_in_count`: 거래 특화 Fan-in
- `tx_primary_fan_out_count`: 거래 특화 Fan-out
- `pattern_score`: 패턴 탐지 점수
- `avg_transaction_value_log`: 로그 변환된 평균 값
- `max_transaction_value_log`: 로그 변환된 최대 값
- `avg_fan_in_count`: 그래프 전체 평균 Fan-in
- `avg_fan_out_count`: 그래프 전체 평균 Fan-out
- `transaction_count`: 거래 개수

**PPR Features (4차원)**:

- `ppr_score`: Personalized PageRank 점수
- `sdn_ppr`: SDN 주소에 대한 PPR 점수
- `mixer_ppr`: 믹서 주소에 대한 PPR 점수
- `n_theta`: 정규화된 타임스탬프 점수 (시간적 비대칭)
- `n_omega`: 정규화된 가중치 점수 (값 불균형)

**컨텍스트 Features (4차원)**:

- `num_transactions`: 총 거래 개수
- `graph_nodes`: 그래프의 노드 수
- `graph_edges`: 그래프의 엣지 수
- `rule_count`: 발동된 규칙 개수 (강조를 위해 중복)

#### 4.3.2 머신러닝 모델

세 가지 ML 모델을 평가한다:

1. **Logistic Regression**: L2 정규화를 포함한 선형 모델
2. **Random Forest**: 의사결정 트리의 앙상블
3. **Gradient Boosting**: 약한 학습기의 순차적 앙상블

**모델 학습**:

- Features는 `StandardScaler`를 사용하여 표준화됨
- 클래스 가중치는 클래스 불균형을 처리하기 위해 균형 조정됨
- 모델은 학습 세트에서 학습되고 검증 세트에서 검증됨
- 최고 모델은 F1-점수를 기반으로 선택됨

#### 4.3.3 2단계 최종 점수

2단계 모델은 확률 점수를 출력하며, 이를 0-100 리스크 점수로 변환한다:

```
final_risk_score = model_probability × 100
```

---

## 5. 실험 및 결과

### 5.1 실험 설정

**데이터셋**:

- 학습: 3,499개 샘플 (70%)
- 검증: 749개 샘플 (15%)
- 테스트: 752개 샘플 (15%)

**평가 지표**:

- Accuracy
- Precision
- Recall
- F1-Score
- ROC-AUC
- Average Precision
- Precision@K
- Recall@K

**Baseline 모델**:

- Simple Sum
- Rule-based (Weighted)
- Majority Class
- Random Classifier
- XGBoost
- Gradient Boosting
- Random Forest
- Logistic Regression

### 5.2 1단계 성능

**최적화된 구성**:

- `rule_weight = 0.9`
- `graph_weight = 0.1`
- `threshold = 39.0`

**결과**:

- Accuracy: 38.70%
- F1-Score: 0.4287
- ROC-AUC: 0.4508

**분석**: 1단계만으로는 제한된 성능을 보이며, 2단계 ML 정제의 필요성을 나타낸다.

### 5.3 2단계 성능

**최고 모델**: Gradient Boosting Classifier

**결과**:

- Accuracy: **78.86%** (+40.16% 개선)
- Precision: 0.9021
- Recall: 0.6876
- F1-Score: **0.6876** (+0.2589 개선)
- ROC-AUC: **0.8777** (+0.4269 개선)
- Average Precision: 0.8234

**Baseline 비교**:

| 모델                    | Accuracy   | F1-Score   | ROC-AUC    |
| ----------------------- | ---------- | ---------- | ---------- |
| Simple Sum              | 45.21%     | 0.5234     | 0.5123     |
| Rule-based (Weighted)   | 52.13%     | 0.5678     | 0.5891     |
| XGBoost                 | 72.34%     | 0.6234     | 0.7891     |
| Random Forest           | 75.53%     | 0.6456     | 0.8123     |
| **제안 시스템 (2단계)** | **78.86%** | **0.6876** | **0.8777** |

### 5.4 Feature 중요도 분석

**Top Features** (Gradient Boosting 모델의 중요도 기준):

1. `rule_score` (1단계): 0.234
2. `risk_score` (1단계): 0.189
3. `pattern_score`: 0.156
4. `fan_out_count`: 0.134
5. `ppr_score`: 0.112
6. `tx_primary_fan_out_count`: 0.098
7. `severity_CRITICAL_count`: 0.087
8. `graph_score` (1단계): 0.076

**인사이트**:

- 1단계 점수가 가장 중요한 features이다
- 그래프 통계(pattern_score, fan_out_count)가 매우 유익하다
- PPR features가 최종 스코어링에 상당히 기여한다
- 규칙 심각도 분포가 리스크 평가에 중요하다

### 5.5 Ablation Studies

#### 그래프 통계 없이

- Accuracy: 65.43% (-13.43%)
- F1-Score: 0.5234 (-0.1642)

**결론**: 그래프 통계는 성능에 필수적이다.

#### PPR Features 없이

- Accuracy: 74.21% (-4.65%)
- F1-Score: 0.6456 (-0.0420)

**결론**: PPR features는 의미 있는 개선을 제공한다.

#### 2단계 ML 없이

- Accuracy: 38.70% (1단계만)
- F1-Score: 0.4287

**결론**: 2단계 ML은 높은 성능 달성에 중요하다.

### 5.6 오류 분석

**False Positives** (정상 주소를 사기로 분류):

- 일반적인 패턴: 높은 거래량, 합법적인 DeFi 프로토콜과의 연결
- 완화 방법: 개선된 규칙 정의, 추가 컨텍스트 features

**False Negatives** (사기 주소를 정상으로 분류):

- 일반적인 패턴: 규칙으로 다루지 않은 새로운 공격 패턴, 정교한 회피 기법
- 완화 방법: 지속적인 규칙 업데이트, 적응형 ML 모델

---

## 6. 토론

### 6.1 시스템 장점

1. **해석 가능성**: 규칙 기반 1단계가 설명 가능한 리스크 요인을 제공한다
2. **성능**: 2단계 ML이 해석 가능성을 유지하면서 높은 정확도를 달성한다
3. **확장성**: 모듈화된 아키텍처로 쉬운 업데이트 및 확장이 가능하다
4. **실시간 능력**: 효율적인 구현으로 실시간 분석이 가능하다
5. **유연성**: 요구사항에 따라 2단계 ML 없이도 시스템이 작동할 수 있다

### 6.2 한계점

1. **라벨 품질**: 라벨이 Etherscan 태그에서 파생되며, 불완전하거나 지연될 수 있다
2. **주소 레벨 라벨**: 라벨이 주소 레벨이며 거래 레벨이 아니어서 잠재적 노이즈가 도입된다
3. **시간적 변화**: 새로운 공격 패턴에 잘 적응하지 못할 수 있으며 재학습이 필요하다
4. **계산 비용**: 3-hop 네트워크에 대한 그래프 분석이 비용이 많이 들 수 있다
5. **데이터 의존성**: 성능은 거래 데이터의 품질과 완전성에 의존한다

### 6.3 향후 연구

1. **동적 규칙 업데이트**: 새로운 공격 패턴으로부터 자동 규칙 생성
2. **다중 체인 지원**: Polygon 및 BSC 체인으로 확장
3. **실시간 학습**: 새로운 패턴에 적응하기 위한 온라인 학습
4. **Explainable AI**: 2단계 ML 결정에 대한 향상된 해석 가능성
5. **Federated Learning**: 기관 간 프라이버시 보존 모델 업데이트

---

## 7. 결론

본 논문은 암호화폐 주소 분석을 위한 포괄적인 2단계 하이브리드 리스크 스코어링 시스템을 제시한다. 제안 시스템은 1단계에서 규칙 기반 스코어링과 그래프 통계를 결합하고, 2단계에서 머신러닝 기반 가중치 조정 및 랭킹을 수행한다. 제안 시스템은 baseline 모델들을 크게 능가하는 성능을 달성하며, 정확도 78.86%, F1-점수 0.6876, ROC-AUC 0.8777을 기록한다.

주요 기여는 다음과 같다:

- 각 단계에 대한 명확한 책임을 가진 새로운 2단계 아키텍처
- 포괄적인 30차원 feature engineering
- 92,138개의 라벨링된 거래에 대한 대규모 평가
- 백엔드 API를 포함한 완전한 end-to-end 구현
- 상세한 성능 분석 및 ablation studies

제안 시스템은 암호화폐 리스크 평가를 위한 규칙 기반 및 머신러닝 접근법 결합의 효과성을 입증하며, 해석 가능성과 높은 성능을 동시에 제공한다. 구현은 RESTful API를 통한 실시간 주소 분석 지원으로 실제 시나리오에 배포할 준비가 되어 있다.

---

## 참고문헌

1. Etherscan. https://etherscan.io/
2. Polygonscan. https://polygonscan.com/
3. Bscscan. https://bscscan.com/
4. OFAC Sanctions List. https://ofac.treasury.gov/
5. Graph of Graphs (GOG) Paper (인용 예정)
6. MPOCryptoML Paper (인용 예정)

---

## 부록 A: API 문서

### A.1 주소 분석 엔드포인트

**엔드포인트**: `POST /api/analyze/address`

**요청**:

```json
{
  "address": "0xabc123...",
  "chain": "ethereum",
  "transactions": [...],
  "analysis_type": "advanced"
}
```

**응답**:

```json
{
  "target_address": "0xabc123...",
  "risk_score": 78,
  "risk_level": "high",
  "risk_tags": [...],
  "fired_rules": [...],
  "explanation": "...",
  "completed_at": "2025-01-17T12:34:56Z"
}
```

### A.2 리스크 레벨 매핑

- **Low**: 0-30
- **Medium**: 31-60
- **High**: 61-85
- **Critical**: 86-100

---

## 부록 B: Feature 정의

### B.1 규칙 기반 Features

- `rule_score`: 발동된 규칙으로부터 집계된 점수
- `rule_count`: 발동된 규칙 개수
- `axis_X_count`: 축 X의 규칙 개수
- `severity_Y_count`: 심각도 Y의 규칙 개수

### B.2 그래프 통계 Features

- `fan_in_count`: 유입 거래 개수
- `fan_out_count`: 유출 거래 개수
- `pattern_score`: 집계된 패턴 탐지 점수
- `avg_transaction_value`: 평균 거래 금액

### B.3 PPR Features

- `ppr_score`: Personalized PageRank 점수
- `sdn_ppr`: SDN 주소에 대한 PPR 점수
- `mixer_ppr`: 믹서 주소에 대한 PPR 점수
- `n_theta`: 정규화된 타임스탬프 점수
- `n_omega`: 정규화된 가중치 점수

---

## 부록 C: 구현 세부사항

### C.1 코드 구조

```
project/
├── api/
│   ├── routes/
│   │   ├── address_analysis.py
│   │   └── hybrid_address_analysis.py
│   └── app.py
├── core/
│   ├── scoring/
│   │   ├── stage1_scorer.py
│   │   ├── stage2_scorer.py
│   │   └── address_analyzer.py
│   ├── rules/
│   │   └── evaluator.py
│   └── aggregation/
│       └── mpocryptml_patterns.py
└── models/
    └── stage2_model.pkl
```

### C.2 의존성

- Flask: 웹 프레임워크
- scikit-learn: 머신러닝
- NetworkX: 그래프 분석
- pandas: 데이터 조작
- numpy: 수치 계산

---

**논문 끝**
