# TRACE-X ë£°ë¶ (Rulebook)

AML (Anti-Money Laundering) ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ë§ì„ ìœ„í•œ TRACE-X ë£°ë¶ ì „ì²´ ì •ë¦¬ ë¬¸ì„œì…ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ë£°ë¶ êµ¬ì¡°](#ë£°ë¶-êµ¬ì¡°)
3. [Compliance (C) ë£°](#compliance-c-ë£°)
4. [Exposure (E) ë£°](#exposure-e-ë£°)
5. [Behavior (B) ë£°](#behavior-b-ë£°)
6. [êµ¬í˜„ ìƒíƒœ](#êµ¬í˜„-ìƒíƒœ)
7. [ì ìˆ˜ ì²´ê³„](#ì ìˆ˜-ì²´ê³„)
8. [ì‚¬ìš© ë°©ë²•](#ì‚¬ìš©-ë°©ë²•)

---

## ê°œìš”

### ë£°ë¶ ì •ë³´

- **ë²„ì „**: 1.0
- **ë„¤ì„ìŠ¤í˜ì´ìŠ¤**: TRACE-X
- **ì„¤ëª…**: Compliance/Exposure/Behavior rulebook v1 (implementation spec)
- **ì´ ë£° ìˆ˜**: 19ê°œ
- **êµ¬í˜„ ì™„ë£Œ**: 11ê°œ
- **ë¶€ë¶„ êµ¬í˜„**: 3ê°œ
- **ë¯¸êµ¬í˜„**: 5ê°œ

### ë£° ì¶• (Axis)

TRACE-X ë£°ë¶ì€ 3ê°€ì§€ ì¶•ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

1. **C (Compliance)**: ê·œì œ ì¤€ìˆ˜ ê´€ë ¨ ë¦¬ìŠ¤í¬
2. **E (Exposure)**: ìœ„í—˜í•œ ì£¼ì†Œ/ì„œë¹„ìŠ¤ì™€ì˜ ë…¸ì¶œ
3. **B (Behavior)**: ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ê±°ë˜ íŒ¨í„´

### ì‹¬ê°ë„ (Severity)

- **HIGH**: ë†’ì€ ë¦¬ìŠ¤í¬ (20~30ì )
- **MEDIUM**: ì¤‘ê°„ ë¦¬ìŠ¤í¬ (15~20ì )
- **LOW**: ë‚®ì€ ë¦¬ìŠ¤í¬ (10~15ì )

---

## ë£°ë¶ êµ¬ì¡°

### ê¸°ë³¸ ì„¤ì •

```yaml
defaults:
  currency: "USD"
  fields:
    timestamp: "timestamp"
    from: "from"
    to: "to"
    usd_value: "usd_value"
    token: "token" # optional
    tx_hash: "tx_hash" # optional
```

### Transaction Direction (IN / OUT)

CEX ê¸°ì¤€ìœ¼ë¡œ ë³´ë©´ ë°©í–¥ ì •ë³´ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.

**Incoming (ì…ê¸ˆ)**

- ì™¸ë¶€ ì£¼ì†Œ â†’ CEX ì§€ê°‘
- ìê¸ˆ ì¶œì²˜(Source of Funds) ê²€ì¦ì— ì¤‘ìš”

**Outgoing (ì¶œê¸ˆ)**

- CEX ì§€ê°‘ â†’ ì™¸ë¶€ ì£¼ì†Œ
- ìê¸ˆ ì‚¬ìš©ì²˜(Usage of Funds), mixer/ì œì¬ ì£¼ì†Œë¡œì˜ ìœ ì¶œ íƒì§€ì— ì¤‘ìš”

**í˜„ì¬ êµ¬í˜„ ìƒíƒœ**:

- APIì—ëŠ” `direction` í•„ë“œê°€ ì—†ì§€ë§Œ, `target_address`ì™€ `from`/`to` ì •ë³´ë¡œ ìë™ íŒë‹¨ ê°€ëŠ¥
  - `target_address == from` â†’ **outgoing** (ì¶œê¸ˆ)
  - `target_address == to` â†’ **incoming** (ì…ê¸ˆ)
- ì¼ë¶€ ë£°(ì˜ˆ: B-502)ì€ íŠ¹ì • ë°©í–¥ì—ë§Œ ë¯¼ê°í•˜ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆìŒ
- í–¥í›„ B-502 ê°™ì€ ë£° êµ¬í˜„ ì‹œ `direction` í•„ë“œê°€ í•„ìš”í•  ìˆ˜ ìˆìŒ

### ë£° êµ¬ì„± ìš”ì†Œ

ê° ë£°ì€ ë‹¤ìŒ ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

- **id**: ë£° ê³ ìœ  ì‹ë³„ì (ì˜ˆ: C-001)
- **name**: ë£° ì´ë¦„
- **axis**: ë£° ì¶• (C, E, B)
- **severity**: ì‹¬ê°ë„ (HIGH, MEDIUM, LOW)
- **description**: ë£° ì„¤ëª… (ì„ íƒ)
- **match**: ë§¤ì¹­ ì¡°ê±´ (ì–´ë–¤ íŠ¸ëœì­ì…˜ì— ì ìš©í• ì§€)
- **conditions**: ì¶”ê°€ ì¡°ê±´ (ê¸ˆì•¡, íšŸìˆ˜ ë“±)
- **exceptions**: ì˜ˆì™¸ ì¡°ê±´ (CEX ë‚´ë¶€ ê±°ë˜ ë“±)
- **score**: ë¦¬ìŠ¤í¬ ì ìˆ˜ (0~30)
- **window**: ì‹œê°„ ìœˆë„ìš° (ì„ íƒ)
- **aggregations**: ì§‘ê³„ ì¡°ê±´ (ì„ íƒ)
- **topology**: ê·¸ë˜í”„ êµ¬ì¡° ì¡°ê±´ (ì„ íƒ)
- **bucket**: ë²„í‚· ì§‘ê³„ ì¡°ê±´ (ì„ íƒ)
- **state**: ì£¼ì†Œ ìƒíƒœ ì¡°ê±´ (ì„ íƒ)

---

## Compliance (C) ë£°

**ëª©ì **: ê·œì œ ì¤€ìˆ˜ ê´€ë ¨ ë¦¬ìŠ¤í¬ ê°ì§€

### C-001: Sanction Direct Touch (ì œì¬ ëŒ€ìƒ ì§ì ‘ ì ‘ì´‰)

- **ID**: C-001
- **ì‹¬ê°ë„**: HIGH
- **ì ìˆ˜**: 30ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: OFAC ì œì¬ ë¦¬ìŠ¤íŠ¸ì— ë“±ë¡ëœ ì£¼ì†Œì™€ ì§ì ‘ ê±°ë˜

**ì¡°ê±´**:

- `from` ë˜ëŠ” `to` ì£¼ì†Œê°€ SDN_LISTì— í¬í•¨
- ê±°ë˜ì•¡ >= 1 USD

**ì˜ˆì™¸**:

- CEX ë‚´ë¶€ ê±°ë˜ (`CEX_INTERNAL` íƒœê·¸)

**ì˜ˆì‹œ**:

```
ê±°ë˜: 0xnormal â†’ 0xsanctioned (100 USD)
â†’ C-001 ë£° ë°œë™ (30ì )
```

---

### C-002: High-Risk Jurisdiction VASP (ê³ ìœ„í—˜ êµ­ê°€ VASP)

- **ID**: C-002
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: 20ì 
- **êµ¬í˜„ ìƒíƒœ**: ğŸš§ ë¶€ë¶„ êµ¬í˜„ (ë°±ì—”ë“œ ë°ì´í„° í•„ìš”)

**ì˜ë¯¸**: ê³ ìœ„í—˜ êµ­ê°€(IR, RU, KP)ì˜ VASPì™€ ê±°ë˜

**ì¡°ê±´**:

- ìƒëŒ€ë°©ì´ ê³ ìœ„í—˜ êµ­ê°€ VASP (`counterparty.country` in ["IR", "RU", "KP"])
- ìƒëŒ€ë°© íƒ€ì…ì´ VASP (`counterparty.type` == "VASP")

**ì˜ˆì™¸**:

- ì•ˆì „í•œ VASP (`counterparty.safe_vasp` == true)

**í•„ìš”í•œ ë°ì´í„°**:

- `counterparty.country`
- `counterparty.type`
- `counterparty.safe_vasp`

**ì‘ë™ ì¡°ê±´**: ë°±ì—”ë“œì—ì„œ counterparty ì •ë³´ ì œê³µ ì‹œ ìë™ ì‘ë™

---

### C-003: High-Value Single Transfer (ê³ ì•¡ ë‹¨ì¼ ê±°ë˜)

- **ID**: C-003
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: 20ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: ë‹¨ì¼ ê±°ë˜ì—ì„œ 7,000 USD ì´ìƒ ì „ì†¡

**ì¡°ê±´**:

- `usd_value >= 7000`

**ì˜ˆì™¸**:

- CEX ë‚´ë¶€ ê±°ë˜ (`CEX_INTERNAL` íƒœê·¸)

**ì˜ˆì‹œ**:

```
ê±°ë˜: 0xuser â†’ 0xrecipient (10,000 USD)
â†’ C-003 ë£° ë°œë™ (20ì )
```

---

### C-004: High-Value Repeated Transfer (24h) (24ì‹œê°„ ë‚´ ë°˜ë³µ ê³ ì•¡ ê±°ë˜)

- **ID**: C-004
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: 20ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: 24ì‹œê°„ ë‚´ ë°˜ë³µì ìœ¼ë¡œ ê³ ì•¡ ê±°ë˜

**ì¡°ê±´** (ìœˆë„ìš° ê¸°ë°˜):

- 24ì‹œê°„ ë‚´ (`duration_sec: 86400`)
- í•©ê³„ >= 10,000 USD
- ê°œìˆ˜ >= 3íšŒ
- ê° ê±°ë˜ >= 3,000 USD

**ì˜ˆì™¸**:

- ë§ˆì¼“ ë©”ì´ì»¤ ë´‡ (`MM_BOT` íƒœê·¸)
- CEX ë‚´ë¶€ ê±°ë˜ (`CEX_INTERNAL` íƒœê·¸)

**ì˜ˆì‹œ**:

```
10:00 - 3,500 USD
15:00 - 4,000 USD
20:00 - 3,500 USD
22:00 - 3,000 USD
â†’ í•©ê³„: 14,000 USD, 4íšŒ ê±°ë˜
â†’ C-004 ë£° ë°œë™ (20ì )
```

---

## Exposure (E) ë£°

**ëª©ì **: ìœ„í—˜í•œ ì£¼ì†Œ/ì„œë¹„ìŠ¤ì™€ì˜ ë…¸ì¶œ ê°ì§€

### E-101: Mixer Direct Exposure (ë¯¹ì„œ ì§ì ‘ ë…¸ì¶œ)

- **ID**: E-101
- **ì‹¬ê°ë„**: HIGH
- **ì ìˆ˜**: 25ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: ë¯¹ì„œ(í† ë„¤ì´ë„ ìºì‹œ ë“±)ì—ì„œ ì§ì ‘ ìê¸ˆ ìœ ì…

**ì¡°ê±´**:

- `from` ì£¼ì†Œê°€ MIXER_LISTì— í¬í•¨
- ê±°ë˜ì•¡ >= 20 USD

**ì˜ˆì™¸**:

- ë¦¬ì›Œë“œ ì§€ê¸‰ (`REWARD_PAYOUT` íƒœê·¸)

**ì˜ˆì‹œ**:

```
ê±°ë˜: 0xmixer â†’ 0xuser (500 USD)
â†’ E-101 ë£° ë°œë™ (25ì )
```

---

### E-102: Indirect Sanctions Exposure (â‰¤2 hops) (ê°„ì ‘ ì œì¬ ë…¸ì¶œ)

- **ID**: E-102
- **ì‹¬ê°ë„**: HIGH
- **ì ìˆ˜**: 30ì 
- **êµ¬í˜„ ìƒíƒœ**: ğŸš§ ë¶€ë¶„ êµ¬í˜„ (PPR ê¸°ë°˜)

**ì˜ë¯¸**: ì œì¬ ëŒ€ìƒê³¼ 1~2í™‰ ì´ë‚´ ê±°ë˜

**ì¡°ê±´**:

- ì£¼ì†Œê°€ SDN_HOP1 ë˜ëŠ” SDN_HOP2 ë¦¬ìŠ¤íŠ¸ì— í¬í•¨
- ê±°ë˜ì•¡ >= 20 USD

**ì˜ˆì™¸**:

- CEX ë‚´ë¶€ ê±°ë˜ (`CEX_INTERNAL` íƒœê·¸)

**êµ¬í˜„ ë°©ì‹**: PPR(PageRank) ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ê°„ì ‘ ì œì¬ ë…¸ì¶œ íƒì§€

**í•„ìš”í•œ ë°ì´í„°**: 3í™‰ê¹Œì§€ ê±°ë˜ íˆìŠ¤í† ë¦¬

---

### E-103: Counterparty Quality Risk (ìƒëŒ€ë°© í’ˆì§ˆ ë¦¬ìŠ¤í¬)

- **ID**: E-103
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: 10~20ì  (ê¸°ë³¸ 15ì )
- **êµ¬í˜„ ìƒíƒœ**: ğŸš§ ë¶€ë¶„ êµ¬í˜„ (ë°±ì—”ë“œ ë°ì´í„° í•„ìš”)

**ì˜ë¯¸**: ìƒëŒ€ë°©ì˜ ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´ê°€ ë†’ìŒ

**ì¡°ê±´**:

- `counterparty.risk_score >= 0.7`

**ì ìˆ˜**: ë™ì  (10~20ì  ë²”ìœ„, ê¸°ë³¸ 15ì )

**í•„ìš”í•œ ë°ì´í„°**:

- `counterparty.risk_score`

**ì‘ë™ ì¡°ê±´**: ë°±ì—”ë“œì—ì„œ `counterparty.risk_score` ì œê³µ ì‹œ ìë™ ì‘ë™

---

## Behavior (B) ë£°

**ëª©ì **: ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ê±°ë˜ íŒ¨í„´ ê°ì§€

### TEMPO (ì‹œê°„ íŒ¨í„´)

#### B-101: Burst (10m) (10ë¶„ ë‚´ ê¸‰ì¦)

- **ID**: B-101
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: 15ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: 10ë¶„ ë‚´ 3íšŒ ì´ìƒ ê±°ë˜

**ì¡°ê±´** (ìœˆë„ìš° ê¸°ë°˜):

- 10ë¶„ ë‚´ (`duration_sec: 600`)
- ê±°ë˜ ê°œìˆ˜ >= 3íšŒ
- ì¿¨ë‹¤ìš´: 30ë¶„ (`cooldown_sec: 1800`)

**ì˜ˆì™¸**:

- CEX ë‚´ë¶€ ê±°ë˜ (`CEX_INTERNAL` íƒœê·¸)
- ë§ˆì¼“ ë©”ì´ì»¤ ë´‡ (`MM_BOT` íƒœê·¸)

**ì˜ˆì‹œ**:

```
10:00 - ê±°ë˜ 1
10:05 - ê±°ë˜ 2
10:08 - ê±°ë˜ 3
â†’ B-101 ë£° ë°œë™ (15ì )
```

---

#### B-102: Rapid Sequence (1m) (1ë¶„ ë‚´ ê¸‰ì† ì—°ì†)

- **ID**: B-102
- **ì‹¬ê°ë„**: HIGH
- **ì ìˆ˜**: 20ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: 1ë¶„ ë‚´ 5íšŒ ì´ìƒ ê±°ë˜

**ì¡°ê±´** (ìœˆë„ìš° ê¸°ë°˜):

- 1ë¶„ ë‚´ (`duration_sec: 60`)
- ê±°ë˜ ê°œìˆ˜ >= 5íšŒ
- ì¿¨ë‹¤ìš´: 15ë¶„ (`cooldown_sec: 900`)

**ì˜ˆì™¸**:

- CEX ë‚´ë¶€ ê±°ë˜ (`CEX_INTERNAL` íƒœê·¸)
- ë§ˆì¼“ ë©”ì´ì»¤ ë´‡ (`MM_BOT` íƒœê·¸)

---

#### B-103: Inter-arrival Std High (ë„ì°© ê°„ê²© í‘œì¤€í¸ì°¨ ë†’ìŒ)

- **ID**: B-103
- **ì‹¬ê°ë„**: LOW
- **ì ìˆ˜**: 10ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: ê±°ë˜ ê°„ê²©ì˜ í‘œì¤€í¸ì°¨ê°€ ë†’ìŒ (ë¶ˆê·œì¹™í•œ íŒ¨í„´)

**ì¡°ê±´**:

- ìµœì†Œ 10ê°œ ê±°ë˜ í•„ìš” (`prerequisites: min_edges: 10`)
- `interarrival_std >= 2.0`
- ê±°ë˜ì•¡ >= 50 USD

---

### TOPOLOGY (ê·¸ë˜í”„ êµ¬ì¡°)

#### B-201: Layering Chain (same token) (ë ˆì´ì–´ë§ ì²´ì¸)

- **ID**: B-201
- **ì‹¬ê°ë„**: HIGH
- **ì ìˆ˜**: 25ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ (ê³ ê¸‰ ë¶„ì„ í•„ìš”)

**ì˜ë¯¸**: ê°™ì€ í† í°ìœ¼ë¡œ 3í™‰ ì´ìƒ ì²´ì¸ ê±°ë˜ (ìê¸ˆ ì„¸íƒ ë ˆì´ì–´ë§)

**ì¡°ê±´** (í† í´ë¡œì§€ ê¸°ë°˜):

- ê°™ì€ í† í° (`same_token: true`)
- í™‰ ê¸¸ì´ >= 3 (`hop_length_gte: 3`)
- ê° í™‰ ê¸ˆì•¡ ì°¨ì´ <= 5% (`hop_amount_delta_pct_lte: 5`)
- ìµœì†Œ ê±°ë˜ì•¡ >= 100 USD (`min_usd_value: 100`)

**âš ï¸ ì£¼ì˜**: ê¸°ë³¸ ìŠ¤ì½”ì–´ë§ì—ì„œëŠ” ì œì™¸ (`analysis_type="advanced"` í•„ìš”)

---

#### B-202: Cycle (length 2-3, same token) (ìˆœí™˜ ê±°ë˜)

- **ID**: B-202
- **ì‹¬ê°ë„**: HIGH
- **ì ìˆ˜**: 30ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ (ê³ ê¸‰ ë¶„ì„ í•„ìš”)

**ì˜ë¯¸**: ê°™ì€ í† í°ìœ¼ë¡œ 2~3í™‰ ìˆœí™˜ ê±°ë˜ íŒ¨í„´

**ì¡°ê±´** (í† í´ë¡œì§€ ê¸°ë°˜):

- ê°™ì€ í† í° (`same_token: true`)
- ìˆœí™˜ ê¸¸ì´: 2~3í™‰ (`cycle_length_in: [2, 3]`)
- ìˆœí™˜ ì´ì•¡ >= 100 USD (`cycle_total_usd_gte: 100`)

**âš ï¸ ì£¼ì˜**: ê¸°ë³¸ ìŠ¤ì½”ì–´ë§ì—ì„œëŠ” ì œì™¸ (`analysis_type="advanced"` í•„ìš”)

---

### BUCKET (ë²„í‚· ì§‘ê³„)

#### B-203: Fan-out (10m bucket) (10ë¶„ ë²„í‚· íŒ¬ì•„ì›ƒ)

- **ID**: B-203
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: 20ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: 10ë¶„ ë‚´ í•œ ì£¼ì†Œì—ì„œ ì—¬ëŸ¬ ì£¼ì†Œë¡œ ëŒ€ëŸ‰ ì†¡ê¸ˆ

**ì¡°ê±´** (ë²„í‚· ê¸°ë°˜):

- 10ë¶„ ë²„í‚· (`size_sec: 600`)
- ê³ ìœ  ìˆ˜ì‹  ì£¼ì†Œ >= 5ê°œ (`distinct_gte: { field: "to", value: 5 }`)
- ì´ì•¡ >= 1,000 USD (`sum_gte: { field: "usd_value", value: 1000 }`)
- ê° ê±°ë˜ >= 100 USD (`every_gte: { field: "usd_value", value: 100 }`)

---

#### B-204: Fan-in (10m bucket) (10ë¶„ ë²„í‚· íŒ¬ì¸)

- **ID**: B-204
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: 20ì 
- **êµ¬í˜„ ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

**ì˜ë¯¸**: 10ë¶„ ë‚´ ì—¬ëŸ¬ ì£¼ì†Œì—ì„œ í•œ ì£¼ì†Œë¡œ ëŒ€ëŸ‰ ì…ê¸ˆ

**ì¡°ê±´** (ë²„í‚· ê¸°ë°˜):

- 10ë¶„ ë²„í‚· (`size_sec: 600`)
- ê³ ìœ  ì†¡ì‹  ì£¼ì†Œ >= 5ê°œ (`distinct_gte: { field: "from", value: 5 }`)
- ì´ì•¡ >= 1,000 USD (`sum_gte: { field: "usd_value", value: 1000 }`)
- ê° ê±°ë˜ >= 100 USD (`every_gte: { field: "usd_value", value: 100 }`)

---

### LIFECYCLE (ì£¼ì†Œ ìƒëª…ì£¼ê¸°)

#### B-401: First 7 Days Burst (ì²« 7ì¼ ê¸‰ì¦)

- **ID**: B-401
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: 20ì 
- **êµ¬í˜„ ìƒíƒœ**: âŒ ë¯¸êµ¬í˜„

**ì˜ë¯¸**: ì£¼ì†Œ ìƒì„± í›„ 7ì¼ ë‚´ ëŒ€ëŸ‰ ê±°ë˜

**ì¡°ê±´** (ìƒíƒœ ê¸°ë°˜):

- ì£¼ì†Œ ë‚˜ì´ <= 7ì¼ (`age_days <= 7`)
- ì²« 7ì¼ ì´ì•¡ >= 10,000 USD (`first7d_usd >= 10000`)
- ì²« 7ì¼ ê±°ë˜ ìˆ˜ >= 3íšŒ (`first7d_tx_count >= 3`)

**í•„ìš”í•œ ê²ƒ**: ì£¼ì†Œ ìƒì„±ì¼(`first_seen_ts`) ì¶”ì , ì²« 7ì¼ê°„ ê±°ë˜ ì§‘ê³„

**ë¯¸êµ¬í˜„ ì´ìœ **: ì£¼ì†Œ ìƒíƒœ ê´€ë¦¬ í•„ìš” (ë³µì¡ë„ ë†’ìŒ)

---

#### B-402: Reactivation (ì¬í™œì„±í™”)

- **ID**: B-402
- **ì‹¬ê°ë„**: LOW
- **ì ìˆ˜**: 15ì 
- **êµ¬í˜„ ìƒíƒœ**: âŒ ë¯¸êµ¬í˜„

**ì˜ë¯¸**: ì˜¤ë˜ëœ ì£¼ì†Œê°€ ì¥ê¸°ê°„ ë¹„í™œì„± í›„ ì¬í™œì„±í™”

**ì¡°ê±´** (ìƒíƒœ ê¸°ë°˜):

- ì£¼ì†Œ ë‚˜ì´ >= 365ì¼ (`age_days >= 365`)
- ë¹„í™œì„± ê¸°ê°„ >= 180ì¼ (`inactive_days >= 180`)
- ì¬í™œì„± ê±°ë˜ ê¸ˆì•¡ >= 1,000 USD (`usd_value >= 1000`)

**í•„ìš”í•œ ê²ƒ**: ì£¼ì†Œ ìƒì„±ì¼, ë§ˆì§€ë§‰ ê±°ë˜ì¼ ì¶”ì 

**ë¯¸êµ¬í˜„ ì´ìœ **: ì£¼ì†Œ ìƒíƒœ ê´€ë¦¬ í•„ìš” (ë³µì¡ë„ ë†’ìŒ)

---

#### B-403A: Lifecycle A â€” Young but Busy (ì Šì§€ë§Œ ë°”ì¨)

- **ID**: B-403A
- **ì‹¬ê°ë„**: LOW
- **ì ìˆ˜**: 10ì 
- **êµ¬í˜„ ìƒíƒœ**: âŒ ë¯¸êµ¬í˜„

**ì˜ë¯¸**: 30ì¼ ì´ë‚´ ì£¼ì†Œê°€ ë§¤ìš° í™œë°œí•œ ê±°ë˜

**ì¡°ê±´**:

- ì£¼ì†Œ ë‚˜ì´ <= 30ì¼ (`age_days <= 30`)
- 30ì¼ ë‚´ ê±°ë˜ ìˆ˜ >= 100íšŒ (`tx_count_30d >= 100`)
- 30ì¼ ë‚´ ì¤‘ê°„ ê¸ˆì•¡ >= 100 USD (`median_usd_30d >= 100`)

**í•„ìš”í•œ ê²ƒ**: ì£¼ì†Œ ë‚˜ì´, 30ì¼ê°„ ê±°ë˜ í†µê³„

**ë¯¸êµ¬í˜„ ì´ìœ **: ì£¼ì†Œ ìƒíƒœ ê´€ë¦¬ í•„ìš” (ë³µì¡ë„ ë†’ìŒ)

---

#### B-403B: Lifecycle B â€” Old and Rare High Value (ì˜¤ë˜ë˜ì—ˆì§€ë§Œ ë“œë¬¼ê²Œ ê³ ì•¡)

- **ID**: B-403B
- **ì‹¬ê°ë„**: LOW
- **ì ìˆ˜**: 10ì 
- **êµ¬í˜„ ìƒíƒœ**: âŒ ë¯¸êµ¬í˜„

**ì˜ë¯¸**: ì˜¤ë˜ëœ ì£¼ì†Œê°€ ë“œë¬¼ê²Œ ê³ ì•¡ ê±°ë˜

**ì¡°ê±´**:

- ì£¼ì†Œ ë‚˜ì´ >= 365ì¼ (`age_days >= 365`)
- ì´ ê±°ë˜ ìˆ˜ <= 10íšŒ (`tx_count_total <= 10`)
- ì´ì•¡ >= 50,000 USD (`total_usd_total >= 50000`)
- ì¤‘ê°„ ê¸ˆì•¡ >= 5,000 USD (`median_usd_total >= 5000`)

**í•„ìš”í•œ ê²ƒ**: ì£¼ì†Œ ë‚˜ì´, ì´ ê±°ë˜ í†µê³„

**ë¯¸êµ¬í˜„ ì´ìœ **: ì£¼ì†Œ ìƒíƒœ ê´€ë¦¬ í•„ìš” (ë³µì¡ë„ ë†’ìŒ)

---

### VALUE (ê¸ˆì•¡ íŒ¨í„´)

#### B-501: High-Value Buckets (ê³ ì•¡ ë²„í‚·)

- **ID**: B-501
- **ì‹¬ê°ë„**: MEDIUM
- **ì ìˆ˜**: ë™ì  (5~20ì )
- **êµ¬í˜„ ìƒíƒœ**: âŒ ë¯¸êµ¬í˜„

**ì˜ë¯¸**: ê±°ë˜ ê¸ˆì•¡ì— ë”°ë¥¸ ë™ì  ì ìˆ˜

**ì¡°ê±´** (ë²„í‚· ê¸°ë°˜):

- 10,000 ~ 50,000 USD: 5ì 
- 50,000 ~ 250,000 USD: 10ì 
- 250,000 ~ 1,000,000 USD: 15ì 
- > = 1,000,000 USD: 20ì 

**ë¯¸êµ¬í˜„ ì´ìœ **: ë™ì  ì ìˆ˜ í• ë‹¹ í•„ìš”

---

#### B-502: Structuring â€” Rounded Value Repetition (24h outgoing) (êµ¬ì¡°í™” - ë°˜ì˜¬ë¦¼ ê°’ ë°˜ë³µ)

- **ID**: B-502
- **ì‹¬ê°ë„**: LOW
- **ì ìˆ˜**: 10ì 
- **êµ¬í˜„ ìƒíƒœ**: âŒ ë¯¸êµ¬í˜„

**ì˜ë¯¸**: 24ì‹œê°„ ë‚´ ë°˜ì˜¬ë¦¼ëœ ê¸ˆì•¡ìœ¼ë¡œ ë°˜ë³µ ì†¡ê¸ˆ (êµ¬ì¡°í™” ì˜ì‹¬)

**ì¡°ê±´** (ìœˆë„ìš° ê¸°ë°˜):

- 24ì‹œê°„ ë‚´ (`duration_sec: 86400`)
- ì†¡ê¸ˆ ë°©í–¥ (`direction:outgoing`)
- í•˜ë‚˜ë¼ë„ >= 10,000,000 USD (KRW ìŠ¤ì¼€ì¼ í—ˆìš©)
- ê°™ì€ ë°˜ì˜¬ë¦¼ ê°’ìœ¼ë¡œ ê·¸ë£¹í™”
- ê° ê·¸ë£¹: ê°œìˆ˜ >= 5íšŒ, í•©ê³„ >= 10,000 USD

**ë¯¸êµ¬í˜„ ì´ìœ **: ë³µí•© ì§‘ê³„ ë° ê·¸ë£¹í™” í•„ìš”

---

## êµ¬í˜„ ìƒíƒœ

### ì „ì²´ í˜„í™©

| ì¹´í…Œê³ ë¦¬           | êµ¬í˜„ ì™„ë£Œ | ë¶€ë¶„ êµ¬í˜„ | ë¯¸êµ¬í˜„ | ì´ê³„   |
| ------------------ | --------- | --------- | ------ | ------ |
| **Compliance (C)** | 2         | 1         | 0      | 3      |
| **Exposure (E)**   | 1         | 2         | 0      | 3      |
| **Behavior (B)**   | 7         | 0         | 5      | 12     |
| **ì´ê³„**           | **11**    | **3**     | **5**  | **19** |

### âœ… êµ¬í˜„ ì™„ë£Œ ë£° (11ê°œ)

1. **C-001**: Sanction Direct Touch
2. **C-003**: High-Value Single Transfer
3. **C-004**: High-Value Repeated Transfer (24h)
4. **E-101**: Mixer Direct Exposure
5. **B-101**: Burst (10m)
6. **B-102**: Rapid Sequence (1m)
7. **B-103**: Inter-arrival Std High
8. **B-201**: Layering Chain (same token) âš ï¸ ê³ ê¸‰ ë¶„ì„ í•„ìš”
9. **B-202**: Cycle (length 2-3, same token) âš ï¸ ê³ ê¸‰ ë¶„ì„ í•„ìš”
10. **B-203**: Fan-out (10m bucket)
11. **B-204**: Fan-in (10m bucket)

### ğŸš§ ë¶€ë¶„ êµ¬í˜„ ë£° (3ê°œ)

1. **C-002**: High-Risk Jurisdiction VASP (ë°±ì—”ë“œ ë°ì´í„° í•„ìš”)
2. **E-102**: Indirect Sanctions Exposure (PPR ê¸°ë°˜ ë¶€ë¶„ êµ¬í˜„)
3. **E-103**: Counterparty Quality Risk (ë°±ì—”ë“œ ë°ì´í„° í•„ìš”)

### âŒ ë¯¸êµ¬í˜„ ë£° (5ê°œ)

1. **B-401**: First 7 Days Burst (ì£¼ì†Œ ìƒíƒœ ê´€ë¦¬ í•„ìš”)
2. **B-402**: Reactivation (ì£¼ì†Œ ìƒíƒœ ê´€ë¦¬ í•„ìš”)
3. **B-403A**: Lifecycle A â€” Young but Busy (ì£¼ì†Œ ìƒíƒœ ê´€ë¦¬ í•„ìš”)
4. **B-403B**: Lifecycle B â€” Old and Rare High Value (ì£¼ì†Œ ìƒíƒœ ê´€ë¦¬ í•„ìš”)
5. **B-501**: High-Value Buckets (ë™ì  ì ìˆ˜ í• ë‹¹ í•„ìš”)
6. **B-502**: Structuring Pattern (ë³µí•© ì§‘ê³„ í•„ìš”)

---

## ì ìˆ˜ ì²´ê³„

### ì ìˆ˜ ë²”ìœ„

- **0~100ì **: ìµœì¢… ë¦¬ìŠ¤í¬ ìŠ¤ì½”ì–´
- ê° ë£°ì€ 0~30ì  ë²”ìœ„ì—ì„œ ê¸°ì—¬
- ì—¬ëŸ¬ ë£°ì´ ë°œë™ë˜ë©´ ì ìˆ˜ê°€ ëˆ„ì ë¨

### ë¦¬ìŠ¤í¬ ë ˆë²¨

| ì ìˆ˜ ë²”ìœ„ | ë ˆë²¨         | ì„¤ëª…             |
| --------- | ------------ | ---------------- |
| 0~30      | **low**      | ë‚®ì€ ë¦¬ìŠ¤í¬      |
| 31~60     | **medium**   | ì¤‘ê°„ ë¦¬ìŠ¤í¬      |
| 61~80     | **high**     | ë†’ì€ ë¦¬ìŠ¤í¬      |
| 81~100    | **critical** | ë§¤ìš° ë†’ì€ ë¦¬ìŠ¤í¬ |

### ì ìˆ˜ ì˜ˆì‹œ

```
C-001 (30ì ) + E-101 (25ì ) + C-003 (20ì ) = 75ì 
â†’ risk_level: "high"
```

---

## ì‚¬ìš© ë°©ë²•

### ê¸°ë³¸ ìŠ¤ì½”ì–´ë§ (ë¹ ë¦„)

ê¸°ë³¸ ìŠ¤ì½”ì–´ë§ì€ ê·¸ë˜í”„ ë£°(B-201, B-202)ì„ ì œì™¸í•œ ëª¨ë“  ë£°ì„ í‰ê°€í•©ë‹ˆë‹¤.

```python
from core.scoring.address_analyzer import AddressAnalyzer

analyzer = AddressAnalyzer()

result = analyzer.analyze_address(
    address="0x...",
    chain="ethereum",
    transactions=txs,
    analysis_type="basic"  # ê¸°ë³¸ê°’
)
```

**í¬í•¨ë˜ëŠ” ë£°**: C-001, C-003, C-004, E-101, B-101, B-102, B-103, B-203, B-204

**ì œì™¸ë˜ëŠ” ë£°**: B-201, B-202 (ê·¸ë˜í”„ ë£°)

**ê²°ê³¼ ì˜ˆì‹œ**:

```json
{
  "address": "0xabc123...",
  "chain": "ethereum",
  "risk_score": 75.0,
  "risk_level": "high",
  "risk_tags": ["mixer_inflow", "sanction_exposure", "high_value_transfer"],
  "fired_rules": [
    { "rule_id": "C-001", "score": 30 },
    { "rule_id": "E-101", "score": 25 },
    { "rule_id": "C-003", "score": 20 }
  ],
  "explanation": "Sanction Direct Touch íŒ¨í„´ ê°ì§€, Mixer Direct Exposure íŒ¨í„´ ê°ì§€, High-Value Single Transfer íŒ¨í„´ ê°ì§€ë¡œ ì¸í•´ high ë¦¬ìŠ¤í¬ë¡œ ë¶„ë¥˜ë¨.",
  "completed_at": "2024-12-17T10:30:45Z"
}
```

---

### ê³ ê¸‰ ìŠ¤ì½”ì–´ë§ (ëŠë¦¼, ê·¸ë˜í”„ ë£° í¬í•¨)

ê³ ê¸‰ ìŠ¤ì½”ì–´ë§ì€ ëª¨ë“  ë£°ì„ í‰ê°€í•˜ë©°, ê·¸ë˜í”„ êµ¬ì¡° ë¶„ì„ì„ í¬í•¨í•©ë‹ˆë‹¤.

```python
result = analyzer.analyze_address(
    address="0x...",
    chain="ethereum",
    transactions=txs,
    analysis_type="advanced"  # ê·¸ë˜í”„ ë£° í¬í•¨
)
```

**í¬í•¨ë˜ëŠ” ë£°**: ëª¨ë“  êµ¬í˜„ëœ ë£° (B-201, B-202 í¬í•¨)

**âš ï¸ ì£¼ì˜**: ê³ ê¸‰ ë¶„ì„ì€ 3í™‰ê¹Œì§€ì˜ ê±°ë˜ íˆìŠ¤í† ë¦¬ê°€ í•„ìš”í•˜ë©°, ì²˜ë¦¬ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤ (5~30ì´ˆ).

**ê²°ê³¼ ì˜ˆì‹œ**:

```json
{
  "address": "0xabc123...",
  "chain": "ethereum",
  "risk_score": 85.0,
  "risk_level": "critical",
  "risk_tags": [
    "mixer_inflow",
    "sanction_exposure",
    "high_value_transfer",
    "layering_chain"
  ],
  "fired_rules": [
    { "rule_id": "C-001", "score": 30 },
    { "rule_id": "E-101", "score": 25 },
    { "rule_id": "B-201", "score": 25 },
    { "rule_id": "C-003", "score": 20 }
  ],
  "explanation": "Sanction Direct Touch íŒ¨í„´ ê°ì§€, Mixer Direct Exposure íŒ¨í„´ ê°ì§€, Layering Chain íŒ¨í„´ ê°ì§€, High-Value Single Transfer íŒ¨í„´ ê°ì§€ë¡œ ì¸í•´ critical ë¦¬ìŠ¤í¬ë¡œ ë¶„ë¥˜ë¨.",
  "completed_at": "2024-12-17T10:31:12Z"
}
```

---

### íŠ¸ëœì­ì…˜ ìŠ¤ì½”ì–´ë§

ë‹¨ì¼ íŠ¸ëœì­ì…˜ì— ëŒ€í•œ ìŠ¤ì½”ì–´ë§ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```python
from core.scoring.engine import TransactionScorer
from core.scoring.engine import TransactionInput

scorer = TransactionScorer()

tx_input = TransactionInput(
    target_address="0x...",
    from_address="0x...",
    to_address="0x...",
    usd_value=10000,
    timestamp="2024-01-01T00:00:00Z",
    chain="ethereum",
    tx_hash="0x..."
)

result = scorer.score_transaction(tx_input)
```

**ê²°ê³¼ ì˜ˆì‹œ**:

```json
{
  "target_address": "0xabc123...",
  "risk_score": 50,
  "risk_level": "medium",
  "risk_tags": ["high_value_transfer"],
  "fired_rules": [
    { "rule_id": "C-003", "score": 20 },
    { "rule_id": "C-004", "score": 20 }
  ],
  "explanation": "High-Value Single Transfer íŒ¨í„´ ê°ì§€, High-Value Repeated Transfer (24h) íŒ¨í„´ ê°ì§€ë¡œ ì¸í•´ medium ë¦¬ìŠ¤í¬ë¡œ ë¶„ë¥˜ë¨.",
  "completed_at": "2024-12-17T10:32:05Z"
}
```

---

## ì˜ˆì™¸ ì²˜ë¦¬

ëŒ€ë¶€ë¶„ì˜ ë£°ì€ ë‹¤ìŒ ì˜ˆì™¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤:

1. **CEX_INTERNAL**: ê±°ë˜ì†Œ ë‚´ë¶€ ê±°ë˜
2. **MM_BOT**: ë§ˆì¼“ ë©”ì´ì»¤ ë´‡
3. **REWARD_PAYOUT**: ë¦¬ì›Œë“œ ì§€ê¸‰

ì´ëŸ¬í•œ ì˜ˆì™¸ëŠ” ì •ìƒì ì¸ ê±°ë˜ íŒ¨í„´ì´ë¯€ë¡œ ë¦¬ìŠ¤í¬ ì ìˆ˜ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.

---

## ë£° í‰ê°€ ë°©ì‹

### 1. ë‹¨ì¼ íŠ¸ëœì­ì…˜ ë£°

**ì˜ˆì‹œ**: C-001, C-003, E-101

```
1. match ì¡°ê±´ í™•ì¸ (ì–´ë–¤ íŠ¸ëœì­ì…˜ì— ì ìš©?)
2. conditions í™•ì¸ (ì¶”ê°€ ì¡°ê±´ ë§Œì¡±?)
3. exceptions í™•ì¸ (ì˜ˆì™¸ì— í•´ë‹¹?)
4. ë£° ë°œë™ â†’ score ì¶”ê°€
```

### 2. ìœˆë„ìš° ê¸°ë°˜ ë£°

**ì˜ˆì‹œ**: C-004, B-101, B-102

```
1. ì‹œê°„ ìœˆë„ìš° ë‚´ íŠ¸ëœì­ì…˜ ìˆ˜ì§‘
2. aggregations ì¡°ê±´ í™•ì¸ (í•©ê³„, ê°œìˆ˜ ë“±)
3. exceptions í™•ì¸
4. ë£° ë°œë™ â†’ score ì¶”ê°€
```

### 3. ë²„í‚· ê¸°ë°˜ ë£°

**ì˜ˆì‹œ**: B-203, B-204

```
1. ì‹œê°„ ë²„í‚·ìœ¼ë¡œ ê·¸ë£¹í™”
2. ë²„í‚·ë³„ ì§‘ê³„ ì¡°ê±´ í™•ì¸
3. ë£° ë°œë™ â†’ score ì¶”ê°€
```

### 4. í† í´ë¡œì§€ ê¸°ë°˜ ë£°

**ì˜ˆì‹œ**: B-201, B-202

```
1. ê·¸ë˜í”„ êµ¬ì¡° ë¶„ì„ (í™‰, ìˆœí™˜ ë“±)
2. í† í´ë¡œì§€ ì¡°ê±´ í™•ì¸
3. ë£° ë°œë™ â†’ score ì¶”ê°€
```

**âš ï¸ ì£¼ì˜**: ê³ ê¸‰ ë¶„ì„(`analysis_type="advanced"`)ì—ì„œë§Œ ì‘ë™

### 5. í†µê³„ ê¸°ë°˜ ë£°

**ì˜ˆì‹œ**: B-103

```
1. prerequisites í™•ì¸ (ìµœì†Œ ê±°ë˜ ìˆ˜ ë“±)
2. í†µê³„ ê³„ì‚° (interarrival_std ë“±)
3. conditions í™•ì¸
4. ë£° ë°œë™ â†’ score ì¶”ê°€
```

---

## ì°¸ê³  ë¬¸ì„œ

- `rules/tracex_rules.yaml`: ë£° ì •ì˜ íŒŒì¼
- `docs/IMPLEMENTED_RULES_SUMMARY.md`: êµ¬í˜„ ìƒíƒœ ìš”ì•½
- `docs/TRACEX_RULES_EXPLAINED.md`: ë£° ìƒì„¸ ì„¤ëª…
- `docs/UNIMPLEMENTED_RULES_SUMMARY.md`: ë¯¸êµ¬í˜„ ë£° ë¶„ì„
- `docs/RISK_SCORING_IMPLEMENTATION_STATUS.md`: êµ¬í˜„ í˜„í™© ìƒì„¸

---

## ë³€ê²½ ì´ë ¥

- **v1.0** (2024): ì´ˆê¸° ë£°ë¶ ì‘ì„±
