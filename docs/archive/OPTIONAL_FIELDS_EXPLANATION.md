# ì„ íƒ í•„ë“œ ì„¤ëª…

`analysis_type`, `time_range`ëŠ” ëª¨ë‘ **ì„ íƒ í•„ë“œ**ì…ë‹ˆë‹¤. ê°ê°ì˜ ëª©ì ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

**ì°¸ê³ **: ìµœìƒìœ„ ë ˆë²¨ì˜ `target_address`ëŠ” ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤. `address` í•„ë“œë§Œ ì‚¬ìš©í•˜ì„¸ìš”.
`transactions` ë°°ì—´ ë‚´ë¶€ì˜ `target_address`ëŠ” ê° íŠ¸ëœì­ì…˜ì˜ ìŠ¤ì½”ì–´ë§ ëŒ€ìƒ ì£¼ì†Œì´ë¯€ë¡œ í•„ìˆ˜ì…ë‹ˆë‹¤.

## ğŸ“‹ í•„ë“œë³„ ëª©ì 

### 1. `analysis_type` (ì„ íƒ)

**ëª©ì **: ë¶„ì„ ê¹Šì´ì™€ ì†ë„ ì œì–´

**ê°’**:

- `"basic"` (ê¸°ë³¸ê°’): ê¸°ë³¸ ë£°ë§Œ í‰ê°€
  - **ì†ë„**: ë¹ ë¦„ (1-2ì´ˆ)
  - **í¬í•¨ ë‚´ìš©**: ê¸°ë³¸ TRACE-X ë£°ë§Œ í‰ê°€
  - **ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤**: ë¹ ë¥¸ ìŠ¤ì½”ì–´ë§ì´ í•„ìš”í•  ë•Œ
- `"advanced"`: ëª¨ë“  ë£° í‰ê°€ + ê·¸ë˜í”„ êµ¬ì¡° ë¶„ì„
  - **ì†ë„**: ëŠë¦¼ (5-30ì´ˆ)
  - **í¬í•¨ ë‚´ìš©**:
    - ëª¨ë“  TRACE-X ë£° í‰ê°€
    - ê·¸ë˜í”„ êµ¬ì¡° ë¶„ì„ (topology analysis)
    - ë” ì •í™•í•œ ìŠ¤ì½”ì–´ë§
  - **ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤**: ì •ë°€í•œ ë¶„ì„ì´ í•„ìš”í•  ë•Œ

**ì½”ë“œì—ì„œì˜ ì‚¬ìš©**:

```python
# core/scoring/address_analyzer.py
include_topology = (analysis_type == "advanced")
fired_rules = self.rule_evaluator.evaluate_single_transaction(
    tx_data,
    include_topology=include_topology  # advancedì¼ ë•Œë§Œ ê·¸ë˜í”„ ë¶„ì„
)
```

**ì˜ˆì‹œ**:

```json
{
  "address": "0xabc123...",
  "chain_id": 1,
  "transactions": [...],
  "analysis_type": "basic"  // ë¹ ë¥¸ ë¶„ì„
}
```

```json
{
  "address": "0xabc123...",
  "chain_id": 1,
  "transactions": [...],
  "analysis_type": "advanced"  // ì •ë°€ ë¶„ì„
}
```

---

---

### 3. `time_range` (ì„ íƒ)

**ëª©ì **: íŠ¹ì • ì‹œê°„ ë²”ìœ„ì˜ íŠ¸ëœì­ì…˜ë§Œ ë¶„ì„

**í˜•ì‹**:

```json
{
  "time_range": {
    "start": "2024-01-01T00:00:00Z", // ì‹œì‘ ì‹œê°„ (ISO8601 UTC)
    "end": "2024-12-31T23:59:59Z" // ì¢…ë£Œ ì‹œê°„ (ISO8601 UTC)
  }
}
```

**ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤**:

- íŠ¹ì • ê¸°ê°„ì˜ ê±°ë˜ë§Œ ë¶„ì„í•˜ê³  ì‹¶ì„ ë•Œ
- ì˜ˆ: "ìµœê·¼ 1ê°œì›” ê±°ë˜ë§Œ ë¶„ì„"
- ì˜ˆ: "2024ë…„ ê±°ë˜ë§Œ ë¶„ì„"

**ì½”ë“œì—ì„œì˜ ì‚¬ìš©**:

```python
# core/scoring/address_analyzer.py
summary = self._create_summary(sorted_txs, time_range)
```

**ì˜ˆì‹œ**:

```json
{
  "address": "0xabc123...",
  "chain_id": 1,
  "transactions": [
    // ë§ì€ ê±°ë˜ë“¤...
  ],
  "time_range": {
    "start": "2024-01-01T00:00:00Z",
    "end": "2024-12-31T23:59:59Z"
  }
}
```

**ì£¼ì˜ì‚¬í•­**:

- `time_range`ë¥¼ ì§€ì •í•´ë„ `transactions` ë°°ì—´ì€ **ë°±ì—”ë“œì—ì„œ í•„í„°ë§**í•´ì•¼ í•¨
- í˜„ì¬ëŠ” ë¶„ì„ ìš”ì•½ì—ë§Œ ì‚¬ìš©ë¨ (ì‹¤ì œ í•„í„°ë§ì€ ë°±ì—”ë“œì—ì„œ)

---

## âœ… ìµœì†Œ í•„ìˆ˜ ì…ë ¥

**í•„ìˆ˜ í•„ë“œë§Œ ì‚¬ìš©**:

```json
{
  "address": "0xabc123...",
  "chain_id": 1,
  "transactions": [
    {
      "tx_hash": "0x123...",
      "chain_id": 1,
      "timestamp": "2025-11-17T12:34:56Z",
      "block_height": 21039493,
      "target_address": "0xabc123...",
      "counterparty_address": "0xdef456...",
      "label": "mixer",
      "is_sanctioned": true,
      "is_known_scam": false,
      "is_mixer": true,
      "is_bridge": false,
      "amount_usd": 5000.0,
      "asset_contract": "0xETH"
    }
  ]
}
```

**ì„ íƒ í•„ë“œ í¬í•¨**:

```json
{
  "address": "0xabc123...",
  "chain_id": 1,
  "transactions": [...],
  "analysis_type": "advanced",  // ì„ íƒ: ì •ë°€ ë¶„ì„
  "time_range": {                // ì„ íƒ: ì‹œê°„ ë²”ìœ„
    "start": "2024-01-01T00:00:00Z",
    "end": "2024-12-31T23:59:59Z"
  }
}
```

---

## ğŸ¯ ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”?

### `analysis_type: "advanced"` ì‚¬ìš© ì‹œê¸°

- âœ… ì •ë°€í•œ ë¶„ì„ì´ í•„ìš”í•  ë•Œ
- âœ… ê·¸ë˜í”„ êµ¬ì¡° ë¶„ì„ì´ í•„ìš”í•  ë•Œ
- âœ… ì‹œê°„ì´ ì¶©ë¶„í•  ë•Œ (5-30ì´ˆ ì†Œìš”)

### `analysis_type: "basic"` ì‚¬ìš© ì‹œê¸° (ê¸°ë³¸ê°’)

- âœ… ë¹ ë¥¸ ìŠ¤ì½”ì–´ë§ì´ í•„ìš”í•  ë•Œ
- âœ… ì‹¤ì‹œê°„ ê²€ì‚¬ê°€ í•„ìš”í•  ë•Œ
- âœ… ê¸°ë³¸ ë£°ë§Œìœ¼ë¡œ ì¶©ë¶„í•  ë•Œ

### `time_range` ì‚¬ìš© ì‹œê¸°

- âœ… íŠ¹ì • ê¸°ê°„ì˜ ê±°ë˜ë§Œ ë¶„ì„í•˜ê³  ì‹¶ì„ ë•Œ
- âœ… ì‹œê°„ ë²”ìœ„ë³„ ë¦¬í¬íŠ¸ê°€ í•„ìš”í•  ë•Œ

---

## ğŸ“Š ì„±ëŠ¥ ë¹„êµ

| ë¶„ì„ íƒ€ì…  | ì†ë„   | ì •í™•ë„ | ê·¸ë˜í”„ ë¶„ì„ |
| ---------- | ------ | ------ | ----------- |
| `basic`    | 1-2ì´ˆ  | ë³´í†µ   | âŒ          |
| `advanced` | 5-30ì´ˆ | ë†’ìŒ   | âœ…          |

---

## ğŸ’¡ ê¶Œì¥ì‚¬í•­

1. **ì¼ë°˜ì ì¸ ê²½ìš°**: ì„ íƒ í•„ë“œ ì—†ì´ ì‚¬ìš© (ê¸°ë³¸ê°’ ì‚¬ìš©)
2. **ë¹ ë¥¸ ê²€ì‚¬**: `analysis_type: "basic"` ëª…ì‹œ
3. **ì •ë°€ ë¶„ì„**: `analysis_type: "advanced"` ì‚¬ìš©
4. **ì‹œê°„ í•„í„°**: `time_range` ì‚¬ìš© (ë°±ì—”ë“œì—ì„œ í•„í„°ë§ í›„)

---

**ê²°ë¡ **: ì„ íƒ í•„ë“œë“¤ì€ ëª¨ë‘ **í¸ì˜ ê¸°ëŠ¥**ì…ë‹ˆë‹¤. í•„ìˆ˜ í•„ë“œë§Œìœ¼ë¡œë„ ì •ìƒ ë™ì‘í•©ë‹ˆë‹¤!
