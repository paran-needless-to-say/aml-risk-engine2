# ì•™ìƒë¸” ëª¨ë¸ ì„¤ëª…

## ğŸ¤” ì•™ìƒë¸” ëª¨ë¸ì´ë€?

**ì•™ìƒë¸” ëª¨ë¸**ì€ ì—¬ëŸ¬ ê°œì˜ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ê²°í•©í•˜ì—¬ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ë‚´ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

### ê¸°ë³¸ ê°œë…

```
ê°œë³„ ëª¨ë¸ë“¤:
  - ëª¨ë¸ A (Gradient Boosting) â†’ ì˜ˆì¸¡: 75ì 
  - ëª¨ë¸ B (Random Forest) â†’ ì˜ˆì¸¡: 78ì 
  - ëª¨ë¸ C (Logistic Regression) â†’ ì˜ˆì¸¡: 72ì 

ì•™ìƒë¸” ëª¨ë¸:
  â†’ ì„¸ ëª¨ë¸ì˜ ì˜ˆì¸¡ì„ í‰ê· /íˆ¬í‘œë¡œ ê²°í•©
  â†’ ìµœì¢… ì˜ˆì¸¡: 75ì  (ë” ì•ˆì •ì ì´ê³  ì •í™•í•¨)
```

## ğŸ“Š í˜„ì¬ ì‹œìŠ¤í…œì—ì„œì˜ ì•™ìƒë¸”

### ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

```
ì‚¬ìš©ì ì…ë ¥ (ì£¼ì†Œ)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage 1: Rule-Based + Graph Stats  â”‚
â”‚ - Rule-based ì ìˆ˜ ê³„ì‚°              â”‚
â”‚ - ê·¸ë˜í”„ í†µê³„ ì ìˆ˜ ê³„ì‚°              â”‚
â”‚ - ê²°í•©: rule_weight Ã— rule_score +  â”‚
â”‚         graph_weight Ã— graph_score  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage 2: AI Weighting/Ranking       â”‚
â”‚                                     â”‚
â”‚  [ì•™ìƒë¸” ëª¨ë¸ì´ ì—¬ê¸° ë“¤ì–´ê°!]        â”‚
â”‚                                     â”‚
â”‚  ê°œë³„ ML ëª¨ë¸ë“¤:                    â”‚
â”‚  - Gradient Boosting (GB)          â”‚
â”‚  - Random Forest (RF)              â”‚
â”‚  - Logistic Regression (LR)       â”‚
â”‚                                     â”‚
â”‚  â†’ Voting Classifierë¡œ ê²°í•©         â”‚
â”‚  â†’ ìµœì¢… ì˜ˆì¸¡                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
ìµœì¢… Risk Score (0~100)
```

### ì•™ìƒë¸” ëª¨ë¸ì˜ ìœ„ì¹˜

**ì•™ìƒë¸” ëª¨ë¸ì€ Stage 2ì—ì„œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.**

- **Stage 1**: Rule-based + Graph Statistics (ì•™ìƒë¸” ì•„ë‹˜)
- **Stage 2**: ì—¬ëŸ¬ ML ëª¨ë¸ë“¤ì„ ì•™ìƒë¸”ë¡œ ê²°í•©

## ğŸ” ì•™ìƒë¸” ëª¨ë¸ ìƒì„¸ ì„¤ëª…

### 1. ê°œë³„ ëª¨ë¸ë“¤

ê°ê° ë‹¤ë¥¸ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ëŠ” ML ëª¨ë¸ë“¤:

```python
# Gradient Boosting
gb = GradientBoostingClassifier(
    n_estimators=200,
    max_depth=5,
    learning_rate=0.1
)
# â†’ ì˜ˆì¸¡: "ì´ ì£¼ì†ŒëŠ” 80% í™•ë¥ ë¡œ Fraud"

# Random Forest
rf = RandomForestClassifier(
    n_estimators=200,
    max_depth=10
)
# â†’ ì˜ˆì¸¡: "ì´ ì£¼ì†ŒëŠ” 75% í™•ë¥ ë¡œ Fraud"

# Logistic Regression
lr = LogisticRegression(
    solver='liblinear',
    class_weight='balanced'
)
# â†’ ì˜ˆì¸¡: "ì´ ì£¼ì†ŒëŠ” 70% í™•ë¥ ë¡œ Fraud"
```

### 2. Voting Classifier (íˆ¬í‘œ ë°©ì‹)

ì—¬ëŸ¬ ëª¨ë¸ì˜ ì˜ˆì¸¡ì„ ê²°í•©:

```python
voting_clf = VotingClassifier(
    estimators=[
        ('gb', gb),  # Gradient Boosting
        ('rf', rf),  # Random Forest
        ('lr', lr)   # Logistic Regression
    ],
    voting='soft',  # Soft voting: í™•ë¥ ì˜ í‰ê· 
    weights=[2, 1, 1]  # GBì— ë” ê°€ì¤‘ì¹˜
)
```

**Soft Voting (í™•ë¥  í‰ê· )**:

```
GB ì˜ˆì¸¡: 80% Fraud
RF ì˜ˆì¸¡: 75% Fraud
LR ì˜ˆì¸¡: 70% Fraud

ê°€ì¤‘ í‰ê· : (80Ã—2 + 75Ã—1 + 70Ã—1) / 4 = 76.25% Fraud
â†’ ìµœì¢… ì˜ˆì¸¡: 76.25% í™•ë¥ ë¡œ Fraud
```

**Hard Voting (ë‹¤ìˆ˜ê²°)**:

```
GB ì˜ˆì¸¡: Fraud (1)
RF ì˜ˆì¸¡: Fraud (1)
LR ì˜ˆì¸¡: Normal (0)

ë‹¤ìˆ˜ê²°: Fraud 2í‘œ > Normal 1í‘œ
â†’ ìµœì¢… ì˜ˆì¸¡: Fraud
```

## ğŸ†š Rule-basedì™€ì˜ ê´€ê³„

### Rule-basedëŠ” Stage 1ì—ì„œ ì‚¬ìš©

```
Stage 1: Rule-Based + Graph Statistics
  â”œâ”€ Rule-based ì ìˆ˜ (ImprovedRuleScorer)
  â””â”€ Graph statistics ì ìˆ˜
  â†’ ê²°í•©í•˜ì—¬ Stage 1 ì ìˆ˜ ìƒì„±

Stage 2: AI Weighting/Ranking
  â”œâ”€ Stage 1 ì ìˆ˜ë¥¼ Featureë¡œ ì‚¬ìš©
  â”œâ”€ ì—¬ëŸ¬ ML ëª¨ë¸ë“¤ (GB, RF, LR)
  â””â”€ ì•™ìƒë¸”ë¡œ ê²°í•©
  â†’ ìµœì¢… ì ìˆ˜ ìƒì„±
```

### Rule-basedì™€ ì•™ìƒë¸”ì˜ ì°¨ì´

| êµ¬ë¶„            | Rule-based                             | ì•™ìƒë¸” ëª¨ë¸             |
| --------------- | -------------------------------------- | ----------------------- |
| **ìœ„ì¹˜**        | Stage 1                                | Stage 2                 |
| **ë°©ì‹**        | ê·œì¹™ í‰ê°€ + ì ìˆ˜ ê³„ì‚°                  | ML ëª¨ë¸ë“¤ì˜ ì˜ˆì¸¡ ê²°í•©   |
| **ì…ë ¥**        | ê±°ë˜ ë°ì´í„°                            | Stage 1 ì ìˆ˜ + Features |
| **ì¶œë ¥**        | Rule score (0~100)                     | ìµœì¢… Risk score (0~100) |
| **í•´ì„ ê°€ëŠ¥ì„±** | ë†’ìŒ (ì–´ë–¤ ë£°ì´ ë°œë™í–ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŒ) | ë‚®ìŒ (ë¸”ë™ë°•ìŠ¤)         |
| **ì„±ëŠ¥**        | ì¤‘ê°„ (38.70% Accuracy)                 | ë†’ìŒ (78.86% Accuracy)  |

## ğŸ’¡ ì™œ ì•™ìƒë¸”ì„ ì‚¬ìš©í•˜ë‚˜?

### 1. ì„±ëŠ¥ í–¥ìƒ

- **ë‹¨ì¼ ëª¨ë¸**: í•œ ëª¨ë¸ì˜ ì•½ì ì´ ì „ì²´ ì„±ëŠ¥ì— ì˜í–¥
- **ì•™ìƒë¸”**: ì—¬ëŸ¬ ëª¨ë¸ì˜ ê°•ì ì„ ê²°í•©í•˜ì—¬ ë” ì•ˆì •ì 

### 2. ì˜¤ë¥˜ ê°ì†Œ

```
ëª¨ë¸ Aê°€ í‹€ë¦´ í™•ë¥ : 20%
ëª¨ë¸ Bê°€ í‹€ë¦´ í™•ë¥ : 20%
ëª¨ë¸ Cê°€ í‹€ë¦´ í™•ë¥ : 20%

ì„¸ ëª¨ë¸ì´ ëª¨ë‘ í‹€ë¦´ í™•ë¥ : 20% Ã— 20% Ã— 20% = 0.8%
â†’ ì•™ìƒë¸”ì´ í‹€ë¦´ í™•ë¥ ì´ í›¨ì”¬ ë‚®ìŒ!
```

### 3. ë‹¤ì–‘í•œ ê´€ì 

- **Gradient Boosting**: ìˆœì°¨ì  í•™ìŠµ, ë³µì¡í•œ íŒ¨í„´ í¬ì°©
- **Random Forest**: ë³‘ë ¬ í•™ìŠµ, ê³¼ì í•© ë°©ì§€
- **Logistic Regression**: ì„ í˜• ê´€ê³„, í•´ì„ ê°€ëŠ¥

ê° ëª¨ë¸ì´ ë‹¤ë¥¸ ê´€ì ì—ì„œ ì˜ˆì¸¡í•˜ë¯€ë¡œ, ê²°í•©í•˜ë©´ ë” ì •í™•í•¨!

## ğŸ“ ì½”ë“œ ì˜ˆì‹œ

### í˜„ì¬ êµ¬í˜„ (improve_stage2_performance.py)

```python
def create_ensemble_model(X_train, y_train, X_val, y_val):
    # 1. ê°œë³„ ëª¨ë¸ë“¤ ìƒì„±
    gb = GradientBoostingClassifier(...)
    rf = RandomForestClassifier(...)
    lr = LogisticRegression(...)

    # 2. Voting Classifierë¡œ ê²°í•©
    voting_clf = VotingClassifier(
        estimators=[
            ('gb', gb),
            ('rf', rf),
            ('lr', lr)
        ],
        voting='soft',  # í™•ë¥  í‰ê· 
        weights=[2, 1, 1]  # GBì— ë” ê°€ì¤‘ì¹˜
    )

    # 3. í•™ìŠµ
    voting_clf.fit(X_train, y_train)

    # 4. ì˜ˆì¸¡
    predictions = voting_clf.predict(X_val)

    return voting_clf
```

## ğŸ¯ ìš”ì•½

### ì•™ìƒë¸” ëª¨ë¸ì€:

1. **AI ëª¨ë¸ë“¤ë¼ë¦¬ ê²°í•©** âœ…

   - Gradient Boosting + Random Forest + Logistic Regression
   - Stage 2ì—ì„œë§Œ ì‚¬ìš©

2. **Rule-basedì™€ëŠ” ë³„ê°œ** âœ…

   - Rule-basedëŠ” Stage 1ì—ì„œ ì‚¬ìš©
   - ì•™ìƒë¸”ì€ Stage 2ì—ì„œ ì—¬ëŸ¬ ML ëª¨ë¸ ê²°í•©

3. **ì„±ëŠ¥ í–¥ìƒ ëª©ì ** âœ…
   - ì—¬ëŸ¬ ëª¨ë¸ì˜ ê°•ì  ê²°í•©
   - ë” ì•ˆì •ì ì´ê³  ì •í™•í•œ ì˜ˆì¸¡

### ì „ì²´ íë¦„:

```
ì…ë ¥ â†’ Stage 1 (Rule-based) â†’ Stage 2 (ì•™ìƒë¸” ML) â†’ ì¶œë ¥
```

**Rule-basedëŠ” ì´ë¯¸ Stage 1ì—ì„œ ì‚¬ìš©ë˜ê³ ,**
**ì•™ìƒë¸”ì€ Stage 2ì—ì„œ ì—¬ëŸ¬ ML ëª¨ë¸ë“¤ì„ ê²°í•©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤!**
