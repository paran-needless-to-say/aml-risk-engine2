# 백엔드 통합 관련 질문

백엔드 팀과 협의할 사항들을 정리했습니다.

## 🤔 확인이 필요한 사항

### 1. API 호출 주체

**질문**: 이 API를 누가 호출하나요?

- [ ] 백엔드 서버에서 직접 호출 (마이크로서비스 간 통신)
- [ ] 프론트엔드에서 직접 호출 (브라우저 → API)
- [ ] 다른 내부 서비스에서 호출
- [ ] 외부 시스템에서 호출

**이유**: 호출 주체에 따라 인증/인가 방식, 에러 처리 방식이 달라질 수 있습니다.

---

### 2. 데이터 흐름

**질문**: 트랜잭션 데이터는 어디서 오나요?

```
[데이터 소스] → [백엔드] → [우리 API] → [응답] → [백엔드] → [프론트엔드?]
```

- **데이터 소스**: Etherscan API? 블록체인 노드? 데이터베이스?
- **백엔드 역할**: 데이터 수집? 가공? 단순 전달?
- **응답 처리**: 백엔드에서 추가 처리? 그대로 프론트로 전달?

**이유**: 데이터 형식과 처리 로직을 맞춰야 합니다.

---

### 3. API 사용 시나리오

**질문**: 언제 이 API를 호출하나요?

- [ ] 실시간 거래 발생 시 (웹소켓/이벤트 기반)
- [ ] 사용자가 주소 조회 시 (요청 기반)
- [ ] 배치 작업 (정기적으로 대량 처리)
- [ ] 수동 조사 시 (관리자 도구)

**이유**: 성능 최적화와 응답 시간 요구사항이 달라집니다.

---

### 4. 트랜잭션 데이터 형식

**질문**: 백엔드에서 보내는 트랜잭션 데이터 형식이 정확히 어떻게 되나요?

현재 우리 API가 기대하는 형식:

```json
{
  "chain_id": 1,
  "transactions": [
    {
      "tx_hash": "0x123...",
      "chain_id": 1, // ✅ chain_id로 변경 완료
      "timestamp": "2025-11-17T12:34:56Z",
      "target_address": "0xabc...",
      "counterparty_address": "0xdef...",
      "label": "mixer",
      "is_sanctioned": true,
      "is_known_scam": false,
      "is_mixer": true,
      "is_bridge": false,
      "amount_usd": 500000.0,
      "asset_contract": "0xETH",
      "block_height": 21039493
    }
  ]
}
```

**확인 필요**:

- `transactions` 배열 내부의 각 트랜잭션에도 `chain_id`가 필요한가요? (현재는 `chain` 문자열)
- `label` 필드는 어떻게 결정되나요? (백엔드에서 라벨링?)
- `is_sanctioned`, `is_known_scam` 등은 어떻게 매핑되나요?

---

### 5. 에러 처리 및 재시도

**질문**: API 호출 실패 시 어떻게 처리하나요?

- 재시도 정책? (몇 번? 지수 백오프?)
- 타임아웃 설정? (몇 초?)
- 실패 시 대체 로직? (기본값 반환? 에러 표시?)

---

### 6. 인증/인가

**질문**: API 인증은 어떻게 하나요?

- [ ] API Key
- [ ] JWT Token
- [ ] 내부 네트워크만 허용 (IP 화이트리스트)
- [ ] 인증 없음 (개발 환경)

**이유**: 보안 설정이 필요합니다.

---

### 7. 성능 요구사항

**질문**: 성능 요구사항이 있나요?

- **응답 시간**: 몇 초 이내?
- **동시 요청**: 초당 몇 건?
- **대량 처리**: 한 번에 몇 개 주소까지?

현재 성능:

- `analysis_type: "basic"`: 1-2초
- `analysis_type: "advanced"`: 5-30초

---

### 8. 배포 및 환경

**질문**: 배포 환경은 어떻게 되나요?

- 개발/스테이징/프로덕션 환경
- Docker/Kubernetes?
- 로드 밸런서?
- 모니터링 도구?

---

## 📋 체크리스트

백엔드 팀과 협의 전 확인:

- [ ] API 엔드포인트 명세 공유
- [ ] 요청/응답 예시 제공
- [ ] Swagger UI 링크 공유
- [ ] 테스트 환경 제공
- [ ] 에러 코드 정의
- [ ] 로깅/모니터링 방식 협의

---

## 💬 질문 템플릿

백엔드 팀에게 보낼 메시지 예시:

```
안녕하세요! 리스크 스코어링 API 통합 관련해서 몇 가지 확인하고 싶은 게 있습니다:

1. 이 API를 누가 호출하나요? (백엔드 서버? 프론트엔드?)

2. 트랜잭션 데이터는 어디서 오나요?
   - Etherscan API?
   - 블록체인 노드?
   - 데이터베이스?

3. API 사용 시나리오는?
   - 실시간 거래 발생 시?
   - 사용자 조회 시?
   - 배치 작업?

4. 트랜잭션 데이터 형식 확인:
   - transactions 배열 내부의 각 트랜잭션에도 chain_id가 필요한가요?
   - label, is_sanctioned 등은 어떻게 결정되나요?

5. 성능 요구사항:
   - 응답 시간: 몇 초 이내?
   - 동시 요청: 초당 몇 건?

6. 인증 방식은 어떻게 되나요?

Swagger UI: http://localhost:5002/api-docs
API 문서: docs/API_DOCUMENTATION.md

테스트해보시고 피드백 주시면 반영하겠습니다!
```

---

## 📚 참고 문서

- **API 문서**: `docs/API_DOCUMENTATION.md`
- **입출력 명세**: `docs/RISK_SCORING_IO.md`
- **배포 가이드**: `docs/DEPLOYMENT_GUIDE.md`
- **테스트 가이드**: `docs/API_TEST_GUIDE.md`
